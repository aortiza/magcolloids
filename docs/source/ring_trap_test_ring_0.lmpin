### ---preamble--- ###
log ./ring_trap_test_ring_0.log
units micro 
atom_style hybrid ellipsoid paramagnet bond 
boundary f f f 
 
neighbor 4.0 bin 
neigh_modify every 1 delay 1 check yes
pair_style hybrid lj/cut/dipole/cut 1 20 
bond_style biharmonic 

### ---Create Particles and Region--- ###
read_data ./ring_trap_test_ring_0.lmpdata
group Atoms type 1 
mass * 1
group Atoms_1 type 1 

### ---Variables--- ###

## magnetic field
variable Bmag atom 0.0
variable freq atom 9.999999999999999e-06
variable theta atom 0.2617993877991494
variable phi atom 0.0

variable fieldx atom v_Bmag*cos(v_freq*time*2*PI+v_phi)*sin(v_theta)
variable fieldy atom v_Bmag*sin(v_freq*time*2*PI+v_phi)*sin(v_theta)
variable fieldz atom v_Bmag*cos(v_theta)

## external force

# Remember that time is in microsecond
# Force is in pg*um/us^2
# k should be in pg/us^2
# r, cx and cy are in um

variable k atom 1e-3

variable R atom 50

variable rho atom sqrt(x*x+y*y)
variable ex atom x/v_rho
variable ey atom y/v_rho

variable dr atom v_rho-v_R

variable Fx atom -v_k*v_dr*v_ex
variable Fy atom -v_k*v_dr*v_ey
variable Fz atom 0


### ---Fixes--- ###

fix 	1 Atoms setdipole v_fieldx v_fieldy v_fieldz 0
fix 	2 Atoms bd 300 0.001 314278 

fix 	3 Atoms addforce 0 0 -0.00032840115205525297 
fix 	6 Atoms wall/lj126 zlo EDGE 0.01 1.7817974362806785  2 zhi EDGE 0.01 1.7817974362806785  2  
fix		8 Atoms addforce v_Fx v_Fy v_Fz
### ---Run Commands--- ###
timestep 	100.0 
dump 	3 all custom 333 ./ring_trap_test_ring_0.lammpstrj id type x	 y	 z
thermo_style 	custom step atoms
thermo 	100  
run 	600000 
