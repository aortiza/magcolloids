units micro
atom_style hybrid ellipsoid paramagnet bond
boundary f f f

neighbor 4.0 bin
neigh_modify every 1 delay 1 check yes
pair_style hybrid lj/cut/dipole/cut 1 20
bond_style biharmonic

### ---Create Particles and Region--- ###
read_data ./ring_trap_test_ring_1.lmpdata
  orthogonal box = (-75 -75 -2.5) to (75 75 2.5)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  20 atoms
  20 ellipsoids
  0 = max # of 1-2 neighbors
  0 = max # of 1-3 neighbors
  0 = max # of 1-4 neighbors
  1 = max # of special neighbors
  special bonds CPU = 1.69277e-05 secs
  read_data CPU = 0.000271082 secs
group Atoms type 1
20 atoms in group Atoms
mass * 1
group Atoms_1 type 1
20 atoms in group Atoms_1

### ---Variables--- ###

## magnetic field
variable Bmag atom 0.0
variable freq atom 9.999999999999999e-06
variable theta atom 0.2617993877991494
variable phi atom 0.0

variable fieldx atom v_Bmag*cos(v_freq*time*2*PI+v_phi)*sin(v_theta)
variable fieldy atom v_Bmag*sin(v_freq*time*2*PI+v_phi)*sin(v_theta)
variable fieldz atom v_Bmag*cos(v_theta)

## external force

# Remember that time is in microsecond
# Force is in pg*um/us^2
# k should be in pg/us^2
# r, cx and cy are in um

variable k atom 1e-3

variable R atom 50

variable cx atom 5
variable cy atom 0

variable rho atom sqrt((x-v_cx)^2+(y-v_cy)^2)
variable ex atom (x-v_cx)/v_rho
variable ey atom (y-v_cy)/v_rho

variable dr atom v_rho-v_R

variable Fx atom -v_k*v_dr*v_ex
variable Fy atom -v_k*v_dr*v_ey
variable Fz atom 0


### ---Fixes--- ###

fix 	1 Atoms setdipole v_fieldx v_fieldy v_fieldz 0
fix 	2 Atoms bd 300 0.001 300836

fix 	3 Atoms addforce 0 0 -0.00032840115205525297
fix 	6 Atoms wall/lj126 zlo EDGE 0.01 1.7817974362806785  2 zhi EDGE 0.01 1.7817974362806785  2
fix		8 Atoms addforce v_Fx v_Fy v_Fz
### ---Run Commands--- ###
timestep 	100.0
dump 	3 all custom 333 ./ring_trap_test_ring_1.lammpstrj id type x	 y	 z
thermo_style 	custom step atoms
thermo 	100
run 	60000
Neighbor list info ...
  update every 1 steps, delay 1 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 24
  ghost atom cutoff = 24
  binsize = 12, bins = 13 13 1
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/dipole/cut, perpetual, half/full from (2)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
  (2) fix setdipole, perpetual
      attributes: full, newton on
      pair build: full/bin
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 8.376 | 8.376 | 8.376 Mbytes
Step Atoms 
       0       20 
     100       20 
     200       20 
     300       20 
     400       20 
     500       20 
     600       20 
     700       20 
     800       20 
     900       20 
    1000       20 
    1100       20 
    1200       20 
    1300       20 
    1400       20 
    1500       20 
    1600       20 
    1700       20 
    1800       20 
    1900       20 
    2000       20 
    2100       20 
    2200       20 
    2300       20 
    2400       20 
    2500       20 
    2600       20 
    2700       20 
    2800       20 
    2900       20 
    3000       20 
    3100       20 
    3200       20 
    3300       20 
    3400       20 
    3500       20 
    3600       20 
    3700       20 
    3800       20 
    3900       20 
    4000       20 
    4100       20 
    4200       20 
    4300       20 
    4400       20 
    4500       20 
    4600       20 
    4700       20 
    4800       20 
    4900       20 
    5000       20 
    5100       20 
    5200       20 
    5300       20 
    5400       20 
    5500       20 
    5600       20 
    5700       20 
    5800       20 
    5900       20 
    6000       20 
    6100       20 
    6200       20 
    6300       20 
    6400       20 
    6500       20 
    6600       20 
    6700       20 
    6800       20 
    6900       20 
    7000       20 
    7100       20 
    7200       20 
    7300       20 
    7400       20 
    7500       20 
    7600       20 
    7700       20 
    7800       20 
    7900       20 
    8000       20 
    8100       20 
    8200       20 
    8300       20 
    8400       20 
    8500       20 
    8600       20 
    8700       20 
    8800       20 
    8900       20 
    9000       20 
    9100       20 
    9200       20 
    9300       20 
    9400       20 
    9500       20 
    9600       20 
    9700       20 
    9800       20 
    9900       20 
   10000       20 
   10100       20 
   10200       20 
   10300       20 
   10400       20 
   10500       20 
   10600       20 
   10700       20 
   10800       20 
   10900       20 
   11000       20 
   11100       20 
   11200       20 
   11300       20 
   11400       20 
   11500       20 
   11600       20 
   11700       20 
   11800       20 
   11900       20 
   12000       20 
   12100       20 
   12200       20 
   12300       20 
   12400       20 
   12500       20 
   12600       20 
   12700       20 
   12800       20 
   12900       20 
   13000       20 
   13100       20 
   13200       20 
   13300       20 
   13400       20 
   13500       20 
   13600       20 
   13700       20 
   13800       20 
   13900       20 
   14000       20 
   14100       20 
   14200       20 
   14300       20 
   14400       20 
   14500       20 
   14600       20 
   14700       20 
   14800       20 
   14900       20 
   15000       20 
   15100       20 
   15200       20 
   15300       20 
   15400       20 
   15500       20 
   15600       20 
   15700       20 
   15800       20 
   15900       20 
   16000       20 
   16100       20 
   16200       20 
   16300       20 
   16400       20 
   16500       20 
   16600       20 
   16700       20 
   16800       20 
   16900       20 
   17000       20 
   17100       20 
   17200       20 
   17300       20 
   17400       20 
   17500       20 
   17600       20 
   17700       20 
   17800       20 
   17900       20 
   18000       20 
   18100       20 
   18200       20 
   18300       20 
   18400       20 
   18500       20 
   18600       20 
   18700       20 
   18800       20 
   18900       20 
   19000       20 
   19100       20 
   19200       20 
   19300       20 
   19400       20 
   19500       20 
   19600       20 
   19700       20 
   19800       20 
   19900       20 
   20000       20 
   20100       20 
   20200       20 
   20300       20 
   20400       20 
   20500       20 
   20600       20 
   20700       20 
   20800       20 
   20900       20 
   21000       20 
   21100       20 
   21200       20 
   21300       20 
   21400       20 
   21500       20 
   21600       20 
   21700       20 
   21800       20 
   21900       20 
   22000       20 
   22100       20 
   22200       20 
   22300       20 
   22400       20 
   22500       20 
   22600       20 
   22700       20 
   22800       20 
   22900       20 
   23000       20 
   23100       20 
   23200       20 
   23300       20 
   23400       20 
   23500       20 
   23600       20 
   23700       20 
   23800       20 
   23900       20 
   24000       20 
   24100       20 
   24200       20 
   24300       20 
   24400       20 
   24500       20 
   24600       20 
   24700       20 
   24800       20 
   24900       20 
   25000       20 
   25100       20 
   25200       20 
   25300       20 
   25400       20 
   25500       20 
   25600       20 
   25700       20 
   25800       20 
   25900       20 
   26000       20 
   26100       20 
   26200       20 
   26300       20 
   26400       20 
   26500       20 
   26600       20 
   26700       20 
   26800       20 
   26900       20 
   27000       20 
   27100       20 
   27200       20 
   27300       20 
   27400       20 
   27500       20 
   27600       20 
   27700       20 
   27800       20 
   27900       20 
   28000       20 
   28100       20 
   28200       20 
   28300       20 
   28400       20 
   28500       20 
   28600       20 
   28700       20 
   28800       20 
   28900       20 
   29000       20 
   29100       20 
   29200       20 
   29300       20 
   29400       20 
   29500       20 
   29600       20 
   29700       20 
   29800       20 
   29900       20 
   30000       20 
   30100       20 
   30200       20 
   30300       20 
   30400       20 
   30500       20 
   30600       20 
   30700       20 
   30800       20 
   30900       20 
   31000       20 
   31100       20 
   31200       20 
   31300       20 
   31400       20 
   31500       20 
   31600       20 
   31700       20 
   31800       20 
   31900       20 
   32000       20 
   32100       20 
   32200       20 
   32300       20 
   32400       20 
   32500       20 
   32600       20 
   32700       20 
   32800       20 
   32900       20 
   33000       20 
   33100       20 
   33200       20 
   33300       20 
   33400       20 
   33500       20 
   33600       20 
   33700       20 
   33800       20 
   33900       20 
   34000       20 
   34100       20 
   34200       20 
   34300       20 
   34400       20 
   34500       20 
   34600       20 
   34700       20 
   34800       20 
   34900       20 
   35000       20 
   35100       20 
   35200       20 
   35300       20 
   35400       20 
   35500       20 
   35600       20 
   35700       20 
   35800       20 
   35900       20 
   36000       20 
   36100       20 
   36200       20 
   36300       20 
   36400       20 
   36500       20 
   36600       20 
   36700       20 
   36800       20 
   36900       20 
   37000       20 
   37100       20 
   37200       20 
   37300       20 
   37400       20 
   37500       20 
   37600       20 
   37700       20 
   37800       20 
   37900       20 
   38000       20 
   38100       20 
   38200       20 
   38300       20 
   38400       20 
   38500       20 
   38600       20 
   38700       20 
   38800       20 
   38900       20 
   39000       20 
   39100       20 
   39200       20 
   39300       20 
   39400       20 
   39500       20 
   39600       20 
   39700       20 
   39800       20 
   39900       20 
   40000       20 
   40100       20 
   40200       20 
   40300       20 
   40400       20 
   40500       20 
   40600       20 
   40700       20 
   40800       20 
   40900       20 
   41000       20 
   41100       20 
   41200       20 
   41300       20 
   41400       20 
   41500       20 
   41600       20 
   41700       20 
   41800       20 
   41900       20 
   42000       20 
   42100       20 
   42200       20 
   42300       20 
   42400       20 
   42500       20 
   42600       20 
   42700       20 
   42800       20 
   42900       20 
   43000       20 
   43100       20 
   43200       20 
   43300       20 
   43400       20 
   43500       20 
   43600       20 
   43700       20 
   43800       20 
   43900       20 
   44000       20 
   44100       20 
   44200       20 
   44300       20 
   44400       20 
   44500       20 
   44600       20 
   44700       20 
   44800       20 
   44900       20 
   45000       20 
   45100       20 
   45200       20 
   45300       20 
   45400       20 
   45500       20 
   45600       20 
   45700       20 
   45800       20 
   45900       20 
   46000       20 
   46100       20 
   46200       20 
   46300       20 
   46400       20 
   46500       20 
   46600       20 
   46700       20 
   46800       20 
   46900       20 
   47000       20 
   47100       20 
   47200       20 
   47300       20 
   47400       20 
   47500       20 
   47600       20 
   47700       20 
   47800       20 
   47900       20 
   48000       20 
   48100       20 
   48200       20 
   48300       20 
   48400       20 
   48500       20 
   48600       20 
   48700       20 
   48800       20 
   48900       20 
   49000       20 
   49100       20 
   49200       20 
   49300       20 
   49400       20 
   49500       20 
   49600       20 
   49700       20 
   49800       20 
   49900       20 
   50000       20 
   50100       20 
   50200       20 
   50300       20 
   50400       20 
   50500       20 
   50600       20 
   50700       20 
   50800       20 
   50900       20 
   51000       20 
   51100       20 
   51200       20 
   51300       20 
   51400       20 
   51500       20 
   51600       20 
   51700       20 
   51800       20 
   51900       20 
   52000       20 
   52100       20 
   52200       20 
   52300       20 
   52400       20 
   52500       20 
   52600       20 
   52700       20 
   52800       20 
   52900       20 
   53000       20 
   53100       20 
   53200       20 
   53300       20 
   53400       20 
   53500       20 
   53600       20 
   53700       20 
   53800       20 
   53900       20 
   54000       20 
   54100       20 
   54200       20 
   54300       20 
   54400       20 
   54500       20 
   54600       20 
   54700       20 
   54800       20 
   54900       20 
   55000       20 
   55100       20 
   55200       20 
   55300       20 
   55400       20 
   55500       20 
   55600       20 
   55700       20 
   55800       20 
   55900       20 
   56000       20 
   56100       20 
   56200       20 
   56300       20 
   56400       20 
   56500       20 
   56600       20 
   56700       20 
   56800       20 
   56900       20 
   57000       20 
   57100       20 
   57200       20 
   57300       20 
   57400       20 
   57500       20 
   57600       20 
   57700       20 
   57800       20 
   57900       20 
   58000       20 
   58100       20 
   58200       20 
   58300       20 
   58400       20 
   58500       20 
   58600       20 
   58700       20 
   58800       20 
   58900       20 
   59000       20 
   59100       20 
   59200       20 
   59300       20 
   59400       20 
   59500       20 
   59600       20 
   59700       20 
   59800       20 
   59900       20 
   60000       20 
Loop time of 3.66277 on 1 procs for 60000 steps with 20 atoms

Performance: 141532383685893.781 ns/day, 0.000 hours/ns, 16381.063 timesteps/s
83.7% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.066859   | 0.066859   | 0.066859   |   0.0 |  1.83
Bond    | 0.0044181  | 0.0044181  | 0.0044181  |   0.0 |  0.12
Neigh   | 5.1975e-05 | 5.1975e-05 | 5.1975e-05 |   0.0 |  0.00
Comm    | 0.0070989  | 0.0070989  | 0.0070989  |   0.0 |  0.19
Output  | 0.012791   | 0.012791   | 0.012791   |   0.0 |  0.35
Modify  | 3.5382     | 3.5382     | 3.5382     |   0.0 | 96.60
Other   |            | 0.03333    |            |       |  0.91

Nlocal:    20 ave 20 max 20 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    20 ave 20 max 20 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  40 ave 40 max 40 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 2
Ave special neighs/atom = 0
Neighbor list builds = 2
Dangerous builds = 0
Total wall time: 0:00:03
